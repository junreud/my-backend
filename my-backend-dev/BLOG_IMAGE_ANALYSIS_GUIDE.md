# 블로그 이미지 분석 시스템 설명

## 🎯 현재 구현된 Google Vision 기반 광고 분석 시스템

### 1. 분석 대상 이미지
블로그 리뷰에서 추출된 이미지들을 다음과 같은 우선순위로 분석합니다:

#### 이미지 구조 분석
- **1번째 이미지**: 프로필 이미지로 간주 → **분석 제외**
- **2번째 이미지**: 본문 첫 번째 이미지 → **최우선 분석** (광고 표시가 가장 많이 나타나는 위치)
- **3번째 이미지**: 본문 두 번째 이미지 → **보조 분석**
- **4번째 이후**: 추가 이미지들 → **필요 시 분석**

#### 특별한 경우
- **이미지 1개만 있는 경우**: 프로필일 가능성이 높지만 본문일 수도 있으므로 신뢰도 60% 보정 적용

### 2. Google Vision API 4가지 분석 기능

#### 📝 텍스트 감지 (Text Detection)
- 이미지 내 모든 텍스트 추출
- 광고 키워드 검색: "#광고", "#협찬", "sponsored", "제공받음" 등
- 가중치: **25점** (명시적 광고 표시), **15점** (강한 신호), **8점** (약한 신호)

#### 🏷️ 라벨 감지 (Label Detection)
- 이미지 내 객체/개념 자동 인식
- **상업적 라벨**: "product", "package", "cosmetics", "brand", "retail" 등
- **일상적 라벨**: "person", "food", "home", "nature" 등
- 상업적 라벨 비율이 높을수록 광고 가능성 증가

#### 🔶 로고 감지 (Logo Detection)
- 브랜드 로고 자동 인식
- 로고가 감지되면 **강한 광고 신호** (20점/개)
- 예: Nike, Samsung, Apple 등 유명 브랜드 로고

#### 🌐 웹 엔터티 감지 (Web Detection)
- 웹에서 유사한 이미지 검색
- 상품/브랜드 관련 정보 발견
- 상업적 웹사이트 도메인 확인

### 3. 종합 점수 계산

```
최종 점수 = (텍스트 점수 × 1.0) + (로고 점수 × 0.8) + (라벨 점수 × 0.6) + (웹 점수 × 0.4)

광고 판단 기준:
- 본문 첫 번째 이미지: 45점 이상
- 본문 두 번째 이미지: 50점 이상  
- 기타 이미지: 35점 이상
```

### 4. 실시간 진행률 알림

Socket.IO를 통해 다음 단계별로 진행률을 실시간 업데이트:

1. **start (0%)**: 분석 시작
2. **image_analysis (20%)**: 이미지 분석 시작
3. **analyzing_image (50%)**: Google Vision 4가지 기능 실행
4. **main_image_complete (60%)**: 본문 첫 번째 이미지 완료
5. **complete (100%)**: 최종 분석 완료

### 5. 분석 결과 로그

각 이미지별로 다음 정보를 상세히 로그에 기록:

```
✅ Google Vision 종합 분석 완료:
- 이미지: https://blog.example.com/image1.jpg...
- 텍스트: "협찬받은 제품으로 솔직 후기 #광고..."
- 감지된 라벨: cosmetics, product, package
- 감지된 로고: L'Oreal, Estee Lauder
- 웹 엔터티: makeup product, skincare
- 광고 여부: 광고
- 최종 신뢰도: 85%
- 판단 근거: 텍스트에서 광고 키워드 발견 (50점), 브랜드 로고 2개 감지 (40점) - 총 85점
```

### 6. 기존 ChatGPT 방식과의 차이점

| 구분 | ChatGPT Vision | Google Vision |
|------|----------------|---------------|
| 분석 방식 | AI 해석 기반 | 구조적 데이터 추출 |
| 정확도 | 맥락 이해 우수 | 객관적 요소 감지 우수 |
| 속도 | 상대적으로 느림 | 빠름 |
| 비용 | 상대적으로 높음 | 월 1000회 무료 |
| 로그 | 해석 결과만 | 추출된 모든 데이터 |
| 재현성 | 일정하지 않을 수 있음 | 항상 동일한 결과 |

현재 시스템은 Google Vision의 객관적 데이터 추출 + 체계적인 점수 계산으로 더 신뢰할 수 있는 광고 분석을 제공합니다.
